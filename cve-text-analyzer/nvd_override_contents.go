package main

import (
	"fmt"

	"github.com/google/uuid"

	"github.com/anchore/vulnerability-data-tools/cve-text-analyzer/internal/reader/cpe"
	"github.com/anchore/vulnerability-data-tools/cve-text-analyzer/internal/search"
)

func nvdOverrideContents(match search.Match) []byte {
	return []byte(fmt.Sprintf(`{
  "cve": {
    "configurations": [
      {
        "nodes": [
          {
            "cpeMatch": [
              {
                "criteria": "%s",
                "matchCriteriaId": "%s",
                "vulnerable": true
              }
            ],
            "negate": false,
            "operator": "OR"
          }
        ]
      }
    ]
  }
}
`,
		cpe.FromID(match.Product.ID),
		uuid.New().String()))
}
